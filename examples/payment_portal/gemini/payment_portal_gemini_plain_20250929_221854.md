# Test Cases - Plain English Format (Multi-Provider)

**Generated on:** 2025-09-29 22:26:12

**User Story:** As a customer of an e-commerce platform,
I want to securely process my payment through a comprehensive payment portal,
So that I can complete my purchase quickly and safely with multiple payment options.

**LLM Provider(s):** gemini

---

## Test Case 1: Successful Payment with Credit Card & Discount (Generated by: None)

**Description:** Verify a customer can successfully complete a purchase using a valid credit card and apply a promotional discount code, ensuring the order summary reflects the changes.

**Type:** positive

**Preconditions:** Customer has items in their cart, navigated to the payment portal. A valid promotional code 'SAVE10' is active and configured in the system.

**Steps:**
1. On the payment portal UI, select 'Credit/Debit Card' as the payment method.
2. Enter valid credit card details (e.g., a Visa card from `payment_test_data.csv` with sufficient funds).
3. Enter a valid cardholder name and billing address.
4. Locate the 'Promotional Code' field and enter 'SAVE10'.
5. Click 'Apply' (if applicable) or ensure the discount is reflected in the order summary panel.
6. Review the order summary to ensure the discount is applied correctly and the final total amount is accurate.
7. Check the 'Agree to Terms & Conditions' checkbox.
8. Click the 'Pay Now' button.

**Expected Result:** Payment is processed successfully. A transaction confirmation page/message is displayed with a confirmation number. The order summary accurately reflects the applied discount and correct final total. The API returns a 200 OK status code for the `/payments/process` endpoint.

---

## Test Case 2: Payment Declined - Insufficient Funds (Generated by: None)

**Description:** Verify the system correctly handles a payment attempt with insufficient funds, providing clear and actionable feedback to the customer.

**Type:** negative

**Preconditions:** Customer has items in their cart, navigated to the payment portal. A credit card with known insufficient funds is available for testing (e.g., from `payment_test_data.csv`).

**Steps:**
1. On the payment portal UI, select 'Credit/Debit Card'.
2. Enter credit card details known to have insufficient funds (e.g., '4111222233334444' from `payment_test_data.csv`).
3. Enter valid cardholder name and billing address.
4. Check the 'Agree to Terms & Conditions' checkbox.
5. Click the 'Pay Now' button.

**Expected Result:** The payment is declined. A clear error message indicating 'Insufficient Funds' or similar is displayed on the UI, prompting the customer to try another payment method or update details. The API returns a 402 (Payment Declined) status code.

---

## Test Case 3: Transaction Amount Boundary - Below Minimum (Generated by: None)

**Description:** Verify the system enforces the minimum transaction amount ($5.00) and prevents payments below this threshold.

**Type:** edge

**Preconditions:** Customer has an item in their cart with a total amount less than $5.00 (e.g., $4.99). Navigated to the payment portal.

**Steps:**
1. Proceed to the payment portal with an order total of $4.99.
2. Select 'Credit/Debit Card' and enter valid payment details.
3. Check the 'Agree to Terms & Conditions' checkbox.
4. Click the 'Pay Now' button.

**Expected Result:** The payment attempt is rejected. An error message is displayed on the UI stating that the transaction amount is below the minimum allowed ($5.00). The API returns a 422 (Unprocessable Entity - Business Rule Violation) status code.

---

## Test Case 4: 3D Secure Authentication for High-Value Transaction from High-Risk Country (Generated by: None)

**Description:** Verify that 3D Secure authentication is correctly triggered for transactions over $100.00 originating from a high-risk country, as per security guidelines.

**Type:** security

**Preconditions:** Customer has an order total greater than $100.00 (e.g., $150.00). The system is configured to identify high-risk countries. A test credit card that supports 3D Secure is available.

**Steps:**
1. On the payment portal UI, select 'Credit/Debit Card'.
2. Enter valid credit card details for a 3D Secure enabled card.
3. Enter a billing address located in a high-risk country (as defined in system configurations).
4. Check the 'Agree to Terms & Conditions' checkbox.
5. Click the 'Pay Now' button.
6. Observe the redirection to the 3D Secure authentication page.
7. Complete the 3D Secure authentication successfully (e.g., by entering a test OTP).

**Expected Result:** The customer is successfully redirected to the 3D Secure authentication page. Upon successful authentication, the payment is processed, and a confirmation is displayed. The transaction is recorded as 3D Secure verified.

---

## Test Case 5: Account Lockout After Multiple Failed Payment Attempts (Generated by: None)

**Description:** Verify that a user's account is locked out for 24 hours after 5 consecutive failed payment attempts due to incorrect credentials (e.g., invalid CVV).

**Type:** security

**Preconditions:** Customer is logged in and on the payment portal. The system is configured for 5 failed attempts leading to a 24-hour lockout.

**Steps:**
1. On the payment portal UI, attempt to process a payment using a valid card number but intentionally incorrect CVV for the first time.
2. Observe the payment failure and error message.
3. Repeat step 1 four more times (total of 5 consecutive failed attempts).
4. Attempt a sixth payment with the same (or any) incorrect credentials.

**Expected Result:** After the 5th failed attempt, the system should lock the user's account for 24 hours. The 6th attempt should result in an error message indicating the account is locked, preventing further payment attempts. The user should not be able to log in or make payments for the lockout duration.

---

## Test Case 6: Payment with Disabled Card Type (Discover) (Generated by: None)

**Description:** Verify that the system correctly rejects payment attempts made with a credit card type explicitly disabled in the business rules (e.g., Discover).

**Type:** negative

**Preconditions:** The `business_rules.xml` specifies 'Discover' as a disabled payment method. Customer is on the payment portal.

**Steps:**
1. On the payment portal UI, select 'Credit/Debit Card'.
2. Enter valid Discover card details (e.g., a test Discover card number).
3. Enter valid cardholder name and billing address.
4. Check the 'Agree to Terms & Conditions' checkbox.
5. Click the 'Pay Now' button.

**Expected Result:** The payment is rejected. An error message is displayed on the UI indicating that the payment method is not supported or declined. The API returns an appropriate error code (e.g., 422 for business rule violation).

---

## Test Case 7: API Rate Limiting Enforcement (Generated by: None)

**Description:** Verify that the payment API enforces rate limiting to prevent abuse and protect system resources, returning a 429 status code when limits are exceeded.

**Type:** api_negative

**Preconditions:** An authenticated user or system is attempting to initiate/process payments. The API has a defined rate limit (e.g., 10 requests per minute) configured.

**Steps:**
1. Rapidly send payment initiation requests (POST `/payments/initiate`) to the API, exceeding the defined rate limit within a short period (e.g., 15 requests in 30 seconds).
2. Monitor the API responses for each request.

**Expected Result:** Initial requests within the defined rate limit should receive 200 OK responses. Once the rate limit is exceeded, subsequent requests should receive a 429 (Too Many Requests) status code. The API response should include a `Retry-After` header indicating when the client can safely retry.

---

## Test Case 8: Session Timeout During Payment Process (Generated by: None)

**Description:** Verify that an inactive user session times out after 15 minutes, requiring re-authentication or restarting the payment process for security.

**Type:** security

**Preconditions:** Customer is logged in and has initiated a payment (e.g., entered some details) but not completed it. The system is configured for a 15-minute session timeout.

**Steps:**
1. Log in as a customer and navigate to the payment portal.
2. Start filling out payment details (e.g., enter the first few digits of a card number).
3. Leave the payment portal page inactive (no user interaction) for more than 15 minutes.
4. Attempt to click the 'Pay Now' button or interact with any form field.

**Expected Result:** The session should be invalidated. The user should be redirected to the login page or an error message indicating session expiration. Any previously entered payment details should be cleared, and the user must restart the payment process from the beginning.

---

